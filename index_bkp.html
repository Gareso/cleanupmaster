<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Cleanup Master â€“ User Guide</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <base href="/" />

  <link rel="stylesheet" href="//cdn.jsdelivr.net/npm/docsify@4/themes/dark.css" />
  <link rel="stylesheet" href="_styles.css" />
</head>
<body>
  <div id="app"></div>

  <script>
    // === IMPORTANT: YOUR NAVBAR HEIGHT ===
    // This value must be the precise height of your fixed top navigation bar.
    // Based on your console output (offsetTop: 60, expected 0), it seems 60 is the navbar height.
    const FIXED_NAVBAR_HEIGHT = 60; // <--- CONFIRM THIS IS YOUR EXACT NAVBAR HEIGHT!

    window.$docsify = {
      name:        'Cleanup Master',
      repo:        'https://www.aescripts.com',
      coverpage:   true,
      onlyCover:   true,
      loadSidebar: true,
      loadNavbar:  true,
      routerMode:  'history',
      sidebarDisplayLevel: 1,
      subMaxLevel: 1,
      logo:        'assets/cleanupMaster.svg',
      plugins: [
        function(hook) {
          const toggleNav = () => {
            const nav   = document.querySelector('.app-nav');
            const cover = document.querySelector('section.cover.show');
            if (nav) nav.style.display = cover ? 'none' : '';
          };
          hook.init(toggleNav);
          hook.doneEach(toggleNav);

          // === Docsify Scroll Adjustment for Fixed Header ===
          hook.afterEach(function() {
            const hash = window.location.hash;
            if (hash) {
              // Use a slightly longer timeout to ensure everything is rendered and docsify's initial scroll finishes.
              setTimeout(() => {
                const targetElement = document.getElementById(hash.substring(1));
                if (targetElement) {
                  // *** THE KEY CHANGE IS HERE ***
                  // 1. Get the target element's position relative to the viewport
                  const targetRect = targetElement.getBoundingClientRect();

                  // 2. Identify the true scroll container
                  const scrollContainer = document.body; // Confirmed by your console output: overflow-y: auto

                  // 3. Calculate the target scroll position
                  // This correctly accounts for the current scroll position of the body
                  // plus the element's position relative to the viewport, minus the navbar.
                  const targetScrollTop = scrollContainer.scrollTop + targetRect.top - FIXED_NAVBAR_HEIGHT;

                  scrollContainer.scrollTo({
                    top: targetScrollTop,
                    behavior: 'smooth'
                  });
                }
              }, 200); // Increased timeout slightly
            }
          });
          // === End Docsify Scroll Adjustment ===
        }
      ]
    };
  </script>

  <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/search.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify@4/lib/plugins/coverpage.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify-sidebar-collapse/dist/docsify-sidebar-collapse.min.js"></script>
  <script src="//cdn.jsdelivr.net/npm/docsify@4"></script>

  <script>
  var player; // Declare player globally to be accessible by seekToChapter

  // This function is called automatically by the YouTube IFrame Player API when it's ready.
  function onYouTubeIframeAPIReady() {
    player = new YT.Player('youtubePlayer', { // 'youtubePlayer' must match the iframe's ID
      events: {
        'onReady': onPlayerReady // Calls onPlayerReady when the player is loaded
      }
    });
  }

  function onPlayerReady(event) {
    console.log('YouTube Player is ready to be controlled!');
    // Optional: You could auto-play the video here if desired:
    // event.target.playVideo();
  }

  // This function is called by your chapter links' onclick events
  function seekToChapter(seconds) {
    if (player && typeof player.seekTo === 'function') {
      player.seekTo(seconds, true); // Seek to the time (true for accurate seek)
      player.playVideo();           // Play the video from that point
    } else {
      console.error('YouTube player not ready or seekTo function not available. Check iframe ID and API loading.');
    }
  }

  // Load the YouTube IFrame Player API script asynchronously
  var tag = document.createElement('script');
  tag.src = "https://www.youtube.com/iframe_api";
  var firstScriptTag = document.getElementsByTagName('script')[0];
  firstScriptTag.parentNode.insertBefore(tag, firstScriptTag);
</script>
</body>
</html>